const __vite__fileDeps=["assets/DataBlock-BUiEZ8Yc.js","assets/DataBlock.vue_vue_type_script_setup_true_lang-CuiVq7Tk.js","assets/index-CjYWDwRe.js","assets/index-BFr-Kuf-.css","assets/AlchemyFav-CqNT1XYL.js","assets/VTooltip-B3OCDW7s.js","assets/VTooltip-03dTmztU.css","assets/VDataTable-C0EOY4WD.js","assets/filter-DomRx7IP.js","assets/filter-DkZWLzKc.css","assets/VDataTable-DQZk-Jjh.css","assets/ExpansionPanel-ip30yW0r.js","assets/ExpansionPanel-BqEw9TtZ.css","assets/AlchemyFav-CR9vpexh.css","assets/AlchemyRaw-HZb1T-3j.js","assets/ItemName.vue_vue_type_script_setup_true_lang-C4lq9eSh.js","assets/VCombobox-DJ9jssC9.js","assets/VCombobox-BksEr4D_.css","assets/VLazy-WeqpWbab.js","assets/VLazy-CMKdyl0R.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as se,f as me,aj as re,g as R,o as c,i as g,D as B,F as _,r as s,z as ce,c as S,w as n,n as pe,H as T,s as W,a8 as F,ak as A,C as M,B as be,a as C,b as l,aa as ve,y as fe,p as m,j as o,e as U,al as X,x as Z,ae as ye,Y as I,ah as H,t as xe,E as ge,ai as Y}from"./index-CjYWDwRe.js";import{u as he,a as ee,b as le,c as $,V as ae,_ as Ve}from"./VLazy-WeqpWbab.js";import{E as we,_ as O,V as te}from"./ExpansionPanel-ip30yW0r.js";import{_ as oe}from"./TheDialog.vue_vue_type_script_setup_true_lang-B1wO2FPW.js";import{D as G}from"./DataTable-BvI74RvD.js";import{b as y,c as ke,V as N,a as Re}from"./VTooltip-B3OCDW7s.js";const Ce=se({__name:"AlchemyResult",props:{idx:{}},setup(J){const P=J,D=me(),h=re(),i=R(()=>P.idx===-1?h.current:h.recipes[P.idx]),r=R(()=>h.allIncomes(P.idx)),b=R(()=>h.cost(P.idx)),p=R(()=>h.hourly(P.idx)),j=R(()=>[{title:"總計",items:[{label:"利潤",value:s(r.value.total-b.value,0)},{label:"收入",value:s(r.value.total,0)},{label:"成本",value:s(b.value,0)},{label:"製作次數",value:`${ce(i.value.crafts,0)} 次`},{label:"時間",value:`${s(i.value.timeCost)} 分鐘`},{label:"原料售出",value:s(r.value.raw,0)}]},{title:"一般產物",items:[{label:"收入",value:s(r.value.regular,0)},{label:"產量",value:s(i.value.num,0)}]},i.value.rareProd?{title:"稀有產物",items:[{label:"收入",value:s(r.value.rare,0)},{label:"產量",value:s(i.value.rareProd.num,2)}]}:void 0]),q=R(()=>{var u,f;const d=p.value;return[{title:"每小時總計",items:[{label:"利潤",value:s(d.profit+(((u=d.rareProd)==null?void 0:u.profit)??0)-d.cost,0)},{label:"收入",value:s(d.profit+(((f=d.rareProd)==null?void 0:f.profit)??0),0)},{label:"成本",value:s(d.cost,0)},{label:"製作",value:`${s(D.alchemyHourlyCrafts,0)} 次`}]},{title:"一般產物",items:[{label:"收入",value:s(d.profit,0)},{label:"產量",value:s(d.yield,0)}]},d.rareProd?{title:"稀有產物",items:[{label:"收入",value:s(d.rareProd.profit,0)},{label:"產量",value:s(d.rareProd.yield,0)}]}:void 0]}),z=R(()=>{if(!i.value.rareProd||!p.value.rareProd)return;const d=h.procToRare(i.value.num),u=(i.value.timeCost+d.timeCost)/60,f=i.value.rareProd.num+d.yield,x=D.profit(f*i.value.rareProd.price),w=b.value+d.cost,V=x-w;return[{title:"加工為稀有產物",items:[{label:"利潤",value:s(V,0)},{label:"收入",value:s(x,0)},{label:"成本",value:s(w,0)},{label:"加工成本",value:s(d.cost,0)},{label:"產量",value:s(f,0)},{label:"時間",value:`${s(h.current.timeCost+d.timeCost,1)} 分鐘`},{label:"加工時間",value:`${s(d.timeCost,1)} 分鐘`}]},{title:"每小時",items:[{label:"利潤",value:s(V/u,0)},{label:"收入",value:s(x/u,0)},{label:"成本",value:s(w/u,0)},{label:"產量",value:s(f/u,0)}]}]});return(d,u)=>(c(!0),g(_,null,B([j.value,q.value,z.value],(f,x)=>{var w;return c(),g(_,{key:x},[f?(c(),S(we,{key:0,title:(w=f[0])==null?void 0:w.title,btnClass:"px-3 py-1 font-weight-bold",textClass:"px-3 pb-3 rounded-b-xl bg-surface",rounded:"xl",expand:""},{default:n(()=>[(c(!0),g(_,null,B(f,(V,E)=>(c(),g(_,{key:`${x}-${E}`},[V?(c(),S(G,{key:0,class:pe(["px-4 py-0",E?"my-1":"mt-n1 mb-1"]),title:V.title,titleClass:E?"ms-n4":"d-none",data:V.items},null,8,["class","title","titleClass","data"])):T("",!0)],64))),128))]),_:2},1032,["title"])):T("",!0)],64)}),128))}}),_e={class:"column-flow full-height"},Pe={class:"column-flow flex-1-1 ga-3 px-4 py-3"},Se={class:"my-1"},Te={class:"d-flex align-end ga-2"},Ue={key:0,class:"ml-2 pl-2 py-2",style:{"border-left":"2px solid black"}},$e={class:"column-flow flex-1-1 ga-3 px-2 py-3 overflow-y-auto",style:{height:"0"}},Ee={class:"my-4 pa-0 overflow-hidden rounded-t-xl rounded-b-lg"},Ae=C("label",{class:"font-weight-bold d-block mb-3"}," 期望產物量 ",-1),Oe={key:0,class:"ml-2 pl-2 py-2",style:{"border-left":"2px solid black"}},Be=C("label",{class:"font-weight-bold d-block mb-3"}," 原料消耗量 ",-1),De=se({__name:"TheAlchemy",setup(J){const P=H({loader:()=>Y(()=>import("./DataBlock-BUiEZ8Yc.js"),__vite__mapDeps([0,1,2,3]))}),D=H({loader:()=>Y(()=>import("./AlchemyFav-CqNT1XYL.js"),__vite__mapDeps([4,2,3,5,6,7,8,9,10,11,12,13]))}),h=H({loader:()=>Y(()=>import("./AlchemyRaw-HZb1T-3j.js"),__vite__mapDeps([14,15,2,3,16,8,5,6,9,17,18,19,1]))}),i=re(),{current:r}=W(i),b=F((()=>{const t={show:!!r.value.rareProd||!!A.elixir.rareProd,...r.value.rareProd??A.elixir.rareProd};return t.num!==void 0&&delete t.num,t})());M(b,t=>{if(!t.show){i.updateRareProd();return}i.updateRareProd({price:t.price?+t.price:0,rate:t.rate?+t.rate:0})}),M(()=>r.value.rareProd,t=>{Object.assign(b,{show:!!t}),t&&Object.assign(b,{price:t.price,rate:t.rate})},{deep:!0});const p=F({show:!1,type:"example",data:"reagent",callback:()=>{}});function j(t,e){Object.assign(p,{show:!0,type:t,data:e,callback:t==="save"?d:z})}const q=[{text:"範例一",tooltip:A.reagent.name,target:"reagent"},{text:"範例二",tooltip:A.elixir.name,target:"elixir"}];function z(){i.overrideCurrent(p.data),Object.assign(p,{show:!1})}function d(){r.value.name&&(i.saveRecipe(),Object.assign(p,{show:!1}))}const u=F({show:!1,crafts:r.value.crafts});M(()=>r.value.crafts,t=>Object.assign(u,{crafts:t}));const f={title:{name:"名稱"},value:{name:"需求量"}},x=be(r.value.raw.map(t=>({label:t.name,value:r.value.crafts*t.consumption}))),w=()=>{x.value=r.value.raw.map(t=>({label:t.name,value:u.crafts*t.consumption}))};M(()=>u.crafts,(t,e)=>t!==e&&w());const V=()=>{Object.assign(u,{show:!u.show}),u.show||i.setCrafts(x.value.map(t=>t.value))},E=he(),{alchemy:v,alchemyReqRaw:ne,alchemyCrafts:ie}=W(E),de=R(()=>ne.value.map((t,e)=>({label:`原料${e+1}`,value:t})));return(t,e)=>(c(),g(_,null,[C("section",_e,[e[0]||(m(-1),e[0]=l(O,{tag:"h2",title:"煉金",icon:"alchemy",color:"alchemy"}),m(1),e[0]),l(ee,{class:"flex-1-1 h-100 bg-alchemy-lighten-2"},{default:n(()=>[l($,{class:"h-100 column-flow",cols:2},{default:n(()=>[e[1]||(m(-1),e[1]=l(O,{tag:"h3",title:"配方",color:"alchemy-lighten-1",rounded:"0"}),m(1),e[1]),C("div",Pe,[l(te,{class:"px-3 py-4",rounded:"xl"},{default:n(()=>[l(y,{class:"mb-3",label:"名稱",dirty:"",density:"compact","model-value":o(r).name,"onUpdate:modelValue":e[2]||(e[2]=a=>o(i).updateRecipe("name",a))},null,8,["model-value"]),l(y,{class:"my-3",label:"出售價",type:"number",inputmode:"decimal",min:"0",density:"compact","model-value":o(r).price,"onUpdate:modelValue":e[3]||(e[3]=a=>o(i).updateRecipe("price",a))},null,8,["model-value"]),C("div",Se,[e[4]||(m(-1),e[4]=l(ke,{class:"d-block text-caption mb-n2"},{default:n(()=>[U(" 產量範圍 ")]),_:1}),m(1),e[4]),C("div",Te,[l(y,{class:"flex-1-1-100",label:"最小值","single-line":"",type:"number",inputmode:"decimal",min:"0",density:"compact",max:o(r).yieldRange[1],"model-value":o(r).yieldRange[0],"onUpdate:modelValue":e[5]||(e[5]=a=>o(i).updateRecipe("yieldRange",a,0))},null,8,["max","model-value"]),U(" ~ "),l(y,{class:"flex-1-1-100",label:"最大值","single-line":"",type:"number",inputmode:"decimal",density:"compact",min:o(r).yieldRange[0],"model-value":o(r).yieldRange[1],"onUpdate:modelValue":e[6]||(e[6]=a=>o(i).updateRecipe("yieldRange",a,1))},null,8,["min","model-value"])])]),l(ae,{class:"ms-n1 mb-n1",label:"稀有產物",density:"compact",ripple:!1,modelValue:b.show,"onUpdate:modelValue":e[7]||(e[7]=a=>b.show=a)},null,8,["modelValue"]),l(X,null,{default:n(()=>[b.show?(c(),g("div",Ue,[l(y,{class:"mb-3",label:"稀有產物比例",type:"number",min:"0",step:"0.01",density:"compact",modelValue:b.rate,"onUpdate:modelValue":e[8]||(e[8]=a=>b.rate=a)},{default:n(()=>[l(N,{activator:"parent",location:"top",text:"取決於製作次數"})]),_:1},8,["modelValue"]),l(y,{label:"售出價",type:"number",inputmode:"decimal",min:"0",density:"compact","model-value":b.price,"onUpdate:modelValue":e[9]||(e[9]=a=>b.price=a)},null,8,["model-value"])])):T("",!0)]),_:1})]),_:1})])]),_:1}),e[10]||(m(-1),e[10]=l(Z,{vertical:"",thickness:"2",opacity:"1",color:"surface"}),m(1),e[10]),l($,{class:"column-flow h-100"},{default:n(()=>[e[11]||(m(-1),e[11]=l(O,{tag:"h3",title:"原料",color:"alchemy-lighten-1",rounded:"0"}),m(1),e[11]),l(te,{class:"flex-1-1 px-4 bg-transparent text-center"},{default:n(()=>[(c(!0),g(_,null,B(o(r).raw,(a,k)=>(c(),S(o(h),{key:k,idx:k,raw:a},null,8,["idx","raw"]))),128)),l(Ve,{type:"append",onClick:o(i).appendRaw,disabled:o(r).raw.length>=5},null,8,["onClick","disabled"])]),_:1})]),_:1}),e[12]||(m(-1),e[12]=l(Z,{vertical:"",thickness:"3",opacity:"1",color:"surface"}),m(1),e[12]),l($,{class:"column-flow h-100",cols:"3"},{default:n(()=>[e[13]||(m(-1),e[13]=l(O,{tag:"h3",title:"結果",color:"alchemy-lighten-1",rounded:"0"}),m(1),e[13]),C("div",$e,[l(Ce,{idx:-1})])]),_:1})]),_:1}),e[14]||(m(-1),e[14]=l(ve,{class:"flex-0-0 ga-5 px-4 py-2 bg-alchemy",variant:"text",rounded:"b-lg t-0"},{default:n(()=>[(c(),g(_,null,B(q,a=>l(I,{key:a.target,"prepend-icon":"mdi-broom",rounded:"lg",onClick:k=>j("example",a.target)},{default:n(()=>[U(xe(a.text)+" ",1),a.tooltip?(c(),S(N,{key:0,text:a.tooltip,activator:"parent",location:"bottom"},null,8,["text"])):T("",!0)]),_:2},1032,["onClick"])),64)),l(ye),l(I,{"prepend-icon":"mdi-knob",density:"compact",rounded:"lg",variant:"elevated","base-color":"alchemy-darken-1",onClick:V},{default:n(()=>[U(" 製作次數 ")]),_:1}),l(I,{"prepend-icon":"mdi-file",density:"compact",rounded:"lg",variant:"elevated","base-color":"alchemy-darken-1",disabled:!o(r).name,onClick:a=>j("save")},{default:n(()=>[U(" 儲存 ")]),_:1},8,["disabled","onClick"])]),_:1}),m(1),e[14]),p.show?fe([p.show],()=>(c(),S(oe,{key:0,title:p.type==="save"?"儲存最愛":"覆蓋表單?",text:p.type==="save"?void 0:`範例 ${o(A)[p.data].name}`,modelValue:p.show,"onUpdate:modelValue":e[15]||(e[15]=a=>p.show=a),onConfirm:e[16]||(e[16]=a=>p.callback())},null,8,["title","text","modelValue"])),e,17):T("",!0),u.show?(c(),S(oe,{key:1,title:"製作次數","model-value":u.show,"onUpdate:modelValue":V},{default:n(()=>[l(G,{class:"pa-0",headers:f,data:x.value,"label-width":10},null,8,["data"]),l(y,{class:"pt-4",label:"製作次數",type:"number",inputmode:"decimal",min:"0",density:"compact",modelValue:u.crafts,"onUpdate:modelValue":e[18]||(e[18]=a=>u.crafts=a)},null,8,["modelValue"])]),_:1},8,["model-value"])):T("",!0)]),l(le,{tag:"section","min-height":400,options:{threshold:.5},transition:void 0},{default:n(()=>[l(o(D),{class:"full-height column-flow"})]),_:1}),l(le,{class:"v-container pa-0",tag:"section","min-height":100,options:{threshold:1},transition:"fade-transition"},{default:n(()=>[C("div",Ee,[e[19]||(m(-1),e[19]=l(O,{tag:"h3",title:"原料需求估計",icon:"mdi-calculator-variant-outline",color:"title"}),m(1),e[19]),l(ee,{class:"h-100 justify-center bg-surface px-2 py-2 ga-4 bg-content"},{default:n(()=>[l($,{class:"px-5 pt-4 pb-2 rounded-xl bg-surface",cols:"3"},{default:n(()=>[Ae,l(y,{label:"一般產物",density:"compact",type:"number",inputmode:"decimal",dirty:"",min:"1",modelValue:o(v).demand.regular,"onUpdate:modelValue":e[20]||(e[20]=a=>o(v).demand.regular=a),modelModifiers:{number:!0}},null,8,["modelValue"]),l(ae,{class:"ms-n1 mb-n1",label:"稀有產物",density:"compact",modelValue:o(v).hasRare,"onUpdate:modelValue":e[21]||(e[21]=a=>o(v).hasRare=a)},null,8,["modelValue"]),l(X,null,{default:n(()=>[o(v).hasRare?(c(),g("div",Oe,[l(y,{class:"mb-3",label:"稀有產物",density:"compact",type:"number",inputmode:"decimal",dirty:"",min:"1",modelValue:o(v).demand.rare,"onUpdate:modelValue":e[22]||(e[22]=a=>o(v).demand.rare=a),modelModifiers:{number:!0}},null,8,["modelValue"]),l(y,{class:"mb-2",label:"稀有產物比例",density:"compact",type:"number",inputmode:"decimal",dirty:"",min:"0",step:"0.01",modelValue:o(v).rareRate,"onUpdate:modelValue":e[23]||(e[23]=a=>o(v).rareRate=a),modelModifiers:{number:!0}},{default:n(()=>[l(N,{activator:"parent",location:"top",text:"取決於製作次數"})]),_:1},8,["modelValue"]),l(Re,{id:"to-rare",class:"ms-n1 mb-n2",label:"全製作為稀有產物",density:"compact",modelValue:o(v).toRare,"onUpdate:modelValue":e[24]||(e[24]=a=>o(v).toRare=a)},{label:n(()=>[U(" 全製作為稀有產物 "),l(N,{activator:"parent",location:"top",text:"忽略一般產物數量要求"})]),_:1},8,["modelValue"])])):T("",!0)]),_:1})]),_:1}),l($,{class:"px-5 pt-4 pb-2 rounded-xl bg-surface",cols:"3"},{default:n(()=>[Be,(c(!0),g(_,null,B(o(v).raw,(a,k,je,L)=>{const K=[a];if(L&&L.key===k&&ge(L,K))return L;const Q=(c(),S(y,{key:k,class:"mb-4",label:`原料${k+1}`,density:"compact",type:"number",inputmode:"decimal",min:"1","model-value":a,"onUpdate:modelValue":ue=>o(v).raw[k]=+ue},null,8,["label","model-value","onUpdate:modelValue"]));return Q.memo=K,Q},e,25),128))]),_:1}),l($,{class:"text-subtitle-2 px-5 py-3 rounded-xl bg-surface",cols:"3"},{default:n(()=>[l(o(P),{title:"製作次數",value:o(ie)},null,8,["value"]),l(G,{class:"mt-2 ml-3",title:"原料需求量",titleClass:"text-body-1 font-weight-bold ms-n3",itemSize:"body-1",data:de.value},null,8,["data"])]),_:1})]),_:1})])]),_:1})],64))}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{Ie as T,Ce as _};
